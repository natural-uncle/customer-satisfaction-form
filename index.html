<!-- ğŸ”¹ å•å·ä¸»é  HTML -->
<!DOCTYPE html>

<html lang="zh-Hant">
<head>
<meta charset="utf-8"/> <!-- è¨­å®šå­—å…ƒç·¨ç¢¼ç‚º UTF-8ï¼Œæ”¯æ´ä¸­æ–‡ -->
<meta content="width=device-width, initial-scale=1.0" name="viewport"/> <!-- æ‰‹æ©Ÿè£ç½®é¡¯ç¤ºå„ªåŒ– -->
<title>è‡ªç„¶å¤§å”æ¸…æ´—æœå‹™ï½œé¡§å®¢æ»¿æ„åº¦èª¿æŸ¥</title>
<style>
    /* ============================
       ğŸ”¹ åŸºæœ¬é é¢æ¨£å¼
       ============================ */
    body {
      font-family: "Microsoft JhengHei", sans-serif; /* é è¨­å­—é«” */
      background-color: #f9faf9; /* èƒŒæ™¯è‰²ï¼ˆæ·ºç°ï¼‰ */
      color: #333; /* æ–‡å­—é¡è‰² */
      margin: 0;
      padding: 0;
      transition: all 0.3s ease; /* ä¸»é¡Œåˆ‡æ›å‹•ç•« */
      font-size: 16px; /* é è¨­å­—é«”å¤§å° */
    }

    /* ğŸ”¹ å•å·å®¹å™¨ï¼ˆç™½è‰²å¡ç‰‡ï¼‰ */
    .container {
      max-width: 800px; /* æœ€å¤§å¯¬åº¦é™åˆ¶ */
      margin: 20px auto; /* ä¸Šä¸‹ 20pxï¼Œè‡ªå‹•ç½®ä¸­ */
      background: #ffffff;
      padding: 20px;
      border-radius: 12px; /* åœ“è§’é‚Šæ¡† */
      box-shadow: 0 4px 12px rgba(0,0,0,0.1); /* é™°å½±æ•ˆæœ */
    }

    /* ğŸ”¹ LOGO å€å¡Š */
    .logo { text-align: center; margin-bottom: 20px; }
    .logo img { max-width: 100%; border-radius: 12px; }

    /* ğŸ”¹ å•å·æ¨™é¡Œèˆ‡æ–‡å­— */
    h2 { text-align: center; color: #3a6d4f; margin: 10px 0; font-size: 2rem; }
    p { line-height: 1.7; color: #555; font-size: 1.05rem; }

    /* ğŸ”¹ è¡¨å–®æ¨£å¼ */
    .form-group { margin-bottom: 20px; }
    label { font-weight: bold; display: block; margin-bottom: 8px; color: #3a6d4f; font-size: 1.1rem; }
    .options label { display: block; margin: 5px 0; }

    /* ğŸ”¹ ä¿®æ­£å¾Œè¼¸å…¥æ¡†ï¼ˆçµ±ä¸€æ¨£å¼ï¼‰ */
    textarea, input[type=text] {
      width: 100%;             /* ä½”æ»¿æ•´å€‹å®¹å™¨å¯¬åº¦ */
      box-sizing: border-box;  /* åŒ…å« padding èˆ‡ border */
      padding: 14px;           /* å…§ç¸®ç©ºé–“ */
      border: 1px solid #ccc;  /* é‚Šæ¡† */
      border-radius: 8px;      /* åœ“è§’ */
      font-size: 1rem;
      resize: vertical;        /* åƒ…å…è¨±ä¸Šä¸‹æ‹‰ä¼¸ */
      margin-top: 8px;
    }
    input[type=range] { width: 100%; }

    /* ğŸ”¹ é€å‡ºæŒ‰éˆ• */
    button {
      background: #3a6d4f;
      color: white;
      border: none;
      padding: 14px 20px;
      font-size: 1.1rem;
      border-radius: 8px;
      cursor: pointer;
      display: block;
      margin: 0 auto;
    }
    button:hover { background: #2d523c; }

    /* ğŸ”¹ è¯çµ¡è³‡è¨Šå€å¡Š */
    .contact {
      margin-top: 30px;
      padding: 20px;
      background: #f1f9f1;
      border-radius: 8px;
      font-size: 1rem;
      text-align:center;
    }

    /* ğŸ”¹ æäº¤å¾Œçš„æ„Ÿè¬è¨Šæ¯ */
    .thankyou {
      display: none;
      text-align: center;
      color: green;
      font-size: 1.2rem;
      margin-top: 20px;
    }

    /* ğŸ”¹ ç¤¾ç¾¤æŒ‰éˆ• */
    .btn {
      display: inline-block;
      padding: 12px 20px;
      margin: 5px;
      border-radius: 5px;
      text-decoration: none;
      color: white;
      font-weight: bold;
    }
    .btn-line { background-color: #06c755; } /* LINE ç¶ è‰² */
    .btn-fb { background-color: #1877F2; }   /* Facebook è—è‰² */

    /* ğŸ”¹ é å°¾ */
    .footer { text-align: center; margin-top: 40px; font-size: 0.95rem; color: #777; }
    .note { font-size: 0.95rem; color: #777; margin-top: 4px; }

    /* ğŸ”¹ é€²åº¦æ¢ */
    .progress-container {
      background: #e0e0e0;
      border-radius: 20px;
      margin: 20px 0;
      height: 20px;
      width: 100%;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      background: #3a6d4f;
      width: 0%;
      transition: width 0.3s ease;
    }

    /* ============================
       ğŸ”¹ æš—è‰²æ¨¡å¼æ¨£å¼
       ============================ */
    body.dark { background-color: #121212; color: #eee; }
    body.dark .container { background: #1e1e1e; box-shadow: 0 4px 12px rgba(0,0,0,0.6); }
    body.dark h2, body.dark label { color: #9ad0b1; }
    body.dark p { color: #ccc; }
    body.dark textarea, body.dark input[type=text], body.dark input[type=range] {
      background: #2a2a2a; color: #eee; border: 1px solid #555;
    }
    body.dark button { background: #4da67a; color: #fff; }
    body.dark button:hover { background: #3b7e5b; }
    body.dark .progress-container { background: #333; }
    body.dark .progress-bar { background: #4da67a; }
    body.dark .contact { background: #2a2a2a; color: #ccc; }
    body.dark .footer { color: #aaa; }

    /* ğŸ”¹ ä¸»é¡Œåˆ‡æ›æŒ‰éˆ• */
    .theme-toggle {
      position: fixed;
      top: 15px;
      right: 15px;
      background: #3a6d4f;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 42px;
      height: 42px;
      cursor: pointer;
      font-size: 18px;
    }
    body.dark .theme-toggle { background: #4da67a; }

    /* ============================
       ğŸ”¹ æ‰‹æ©Ÿ RWD å„ªåŒ–
       ============================ */
    @media (max-width: 600px) {
      .container { margin: 10px; padding: 18px; border-radius: 10px; }
      h2 { font-size: 1.5rem; }
      p, label, .note { font-size: 1.05rem; line-height: 1.6; }
      input[type=text], textarea { font-size: 1.05rem; padding: 14px; }
      button { width: 100%; padding: 16px; font-size: 1.15rem; }
      .btn {
        display: block;
        width: 100%;
        box-sizing: border-box;
        text-align: center;
        margin: 10px 0;
        font-size: 1rem;
        padding: 12px;
        white-space: normal; /* å…è¨±æ›è¡Œï¼Œé¿å…å­—å¤ªé•·è¶…å‡º */
      }
      .progress-container { height: 18px; }
      .theme-toggle { top: 10px; right: 10px; }
    }
  </style>
<style id="submit-loading-style">#loadingBackdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.4);z-index:9999}
#loadingBackdrop.show{display:flex}
.loading-card{background:#fff;padding:16px 20px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.2);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.spinner{width:18px;height:18px;border:3px solid #ddd;border-top-color:#888;border-radius:50%;display:inline-block;animation:spin 1s linear infinite;margin-right:8px;vertical-align:-3px}
@keyframes spin{to{transform:rotate(360deg)}}</style></head>
<body>
<!-- ğŸ”¹ ä¸»é¡Œåˆ‡æ›æŒ‰éˆ•ï¼ˆäº®è‰²/æš—è‰²æ¨¡å¼ï¼‰ -->
<button class="theme-toggle" id="themeToggle">ğŸŒ™</button>
<!-- ğŸ”¹ å•å·ä¸»å…§å®¹å®¹å™¨ -->
<div class="container">
<!-- LOGO å€å¡Š -->
<div class="logo">
<img alt="è‡ªç„¶å¤§å”æ¸…æ´—æœå‹™ é¡§å®¢æ»¿æ„åº¦èª¿æŸ¥" src="ChatGPT.png"/>
</div>
<!-- å•å·æ¨™é¡Œèˆ‡ç°¡ä»‹ -->
<h2>èª æ‘¯é‚€è«‹æ‚¨å¡«å¯«æ»¿æ„åº¦èª¿æŸ¥</h2>
<p>æ„Ÿè¬æ‚¨é¸æ“‡ <b>è‡ªç„¶å¤§å”å°ˆæ¥­å®¶é›»æ¸…æ´—æœå‹™</b>ï¼<br/>
    æˆ‘å€‘å§‹çµ‚ç§‰æŒã€Œè®“æ¯ä¸€ä½é¡§å®¢ä¹¾æ·¨ä½¿ç”¨å®¶é›»ã€çš„åˆè¡·ï¼Œè‡´åŠ›æä¾›å®‰å¿ƒã€æ”¾å¿ƒçš„æ¸…æ´—é«”é©—ã€‚</p>
<!-- é€²åº¦æ¢ -->
<div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
<!-- å•å·è¡¨å–®é–‹å§‹ -->
<form action="/.netlify/functions/submit" id="surveyForm" method="POST">
<!-- Q0: å§“å -->
<div class="form-group">
<label>ğŸ‘¤ è«‹ç•™ä¸‹æ‚¨çš„å§“åæˆ– LINE ID</label>
<input name="customer_name" placeholder="è¼¸å…¥å§“åæˆ– LINE ID" type="text"/>
</div>
<!-- Q1 -->
<div class="form-group">
<label>1. æ‚¨å°é€™æ¬¡çš„æ¸…æ´—æœå‹™æ•´é«”é«”é©—æ„Ÿè¦ºå¦‚ä½•ï¼Ÿ</label>
<div class="options">
<label><input name="q1" type="radio" value="éå¸¸æ»¿æ„"/> éå¸¸æ»¿æ„</label>
<label><input name="q1" type="radio" value="æ»¿æ„"/> æ»¿æ„</label>
<label><input name="q1" type="radio" value="æ™®é€š"/> æ™®é€š</label>
<label><input name="q1" type="radio" value="ä¸å¤ªæ»¿æ„"/> ä¸å¤ªæ»¿æ„</label>
<label><input name="q1" type="radio" value="éå¸¸ä¸æ»¿æ„"/> éå¸¸ä¸æ»¿æ„</label>
</div>
</div>
<!-- Q2 -->
<div class="form-group">
<label>2. æ‚¨å°æœå‹™äººå“¡çš„å°ˆæ¥­ç¨‹åº¦æ˜¯å¦æ»¿æ„ï¼Ÿ</label>
<div class="options">
<label><input name="q2" type="radio" value="éå¸¸æ»¿æ„"/> éå¸¸æ»¿æ„</label>
<label><input name="q2" type="radio" value="æ»¿æ„"/> æ»¿æ„</label>
<label><input name="q2" type="radio" value="æ™®é€š"/> æ™®é€š</label>
<label><input name="q2" type="radio" value="ä¸å¤ªæ»¿æ„"/> ä¸å¤ªæ»¿æ„</label>
<label><input name="q2" type="radio" value="éå¸¸ä¸æ»¿æ„"/> éå¸¸ä¸æ»¿æ„</label>
</div>
<textarea name="q2_extra" placeholder="è‹¥æœ‰ç‰¹åˆ¥å°è±¡æˆ–å»ºè­°ï¼Œè«‹å¡«å¯«..."></textarea>
</div>
<!-- Q3 -->
<div class="form-group">
<label>3. æ‚¨èªç‚ºæœå‹™äººå“¡çš„æ•´é«”è¡¨ç¾å¦‚ä½•ï¼Ÿ</label>
<div class="note">ï¼ˆ1åˆ†=éå¸¸ä¸æ»¿æ„ï¼Œ5åˆ†=éå¸¸æ»¿æ„ï¼‰</div>
<div class="options">
<label><input name="q3" type="radio" value="1"/> 1 åˆ†</label>
<label><input name="q3" type="radio" value="2"/> 2 åˆ†</label>
<label><input name="q3" type="radio" value="3"/> 3 åˆ†</label>
<label><input name="q3" type="radio" value="4"/> 4 åˆ†</label>
<label><input name="q3" type="radio" value="5"/> 5 åˆ†</label>
</div>
</div>
<!-- Q4 -->
<div class="form-group">
<label>4. è‹¥æœ‹å‹æˆ–åŒäº‹æœ‰éœ€è¦ï¼Œæ‚¨é¡˜æ„æ¨è–¦è‡ªç„¶å¤§å”çš„æ¸…æ´—æœå‹™å—ï¼Ÿ</label>
<div class="note">ï¼ˆ1åˆ†=å®Œå…¨ä¸æœƒæ¨è–¦ï¼Œ10åˆ†=ä¸€å®šæœƒæ¨è–¦ï¼‰</div>
<input max="10" min="1" name="q4" oninput="this.nextElementSibling.value = this.value" type="range" value="5"/>
<output>5</output>
</div>
<!-- Q5 -->
<div class="form-group">
<label>5. æœªä¾†æ˜¯å¦æœƒå†æ¬¡å§”è¨—è‡ªç„¶å¤§å”é€²è¡Œå®¶é›»æ¸…æ´—æœå‹™ï¼Ÿ</label>
<div class="options">
<label><input name="q5" type="radio" value="ä¸€å®šæœƒ"/> ä¸€å®šæœƒ</label>
<label><input name="q5" type="radio" value="æœ‰éœ€è¦æœƒè€ƒæ…®"/> æœ‰éœ€è¦æœƒè€ƒæ…®</label>
<label><input name="q5" type="radio" value="å¯èƒ½ä¸æœƒ"/> å¯èƒ½ä¸æœƒ</label>
<label><input name="q5" type="radio" value="ä¸æœƒ"/> ä¸æœƒ</label>
</div>
</div>
<!-- Q6 -->
<div class="form-group">
<label>6. æ‚¨å°æˆ‘å€‘çš„æœå‹™æœ‰ä»»ä½•æƒ³æ³•ã€é¼“å‹µæˆ–å»ºè­°å—ï¼Ÿ</label>
<textarea name="q6" placeholder="ğŸ“ è«‹è‡ªç”±å¡«å¯«æ‚¨çš„å»ºè­°..."></textarea>
</div>
<!-- é€å‡ºè¡¨å–® -->
<button type="submit">é€å‡ºè¡¨å–®</button>
<div class="thankyou">âœ… æ„Ÿè¬æ‚¨å¡«å¯«èª¿æŸ¥è¡¨ï¼å³å°‡è·³è½‰...</div>
</form>
<!-- è¯çµ¡è³‡è¨Šï¼ˆåŠ ä¸Šå°åœ–ç¤ºï¼‰ -->
<div class="contact">
<h3>ğŸ“± è¯çµ¡æˆ‘å€‘ï½œè‡ªç„¶å¤§å”</h3>
<a class="btn btn-line" href="https://lin.ee/OHk6Rn7">ğŸŸ¢ LINE å®˜æ–¹å¸³è™Ÿ</a>
<a class="btn btn-fb" href="https://www.facebook.com/naturaluncle">ğŸ”µ Facebook ç²‰çµ²å°ˆé </a>
</div>
<!-- é å°¾ -->
<div class="footer">Â© 2025 è‡ªç„¶å¤§å”ï½œå°ˆæ¥­å®¶é›»æ¸…æ´—æœå‹™</div>
</div>
<!-- ============================
       ğŸ”¹ JavaScript åŠŸèƒ½
       ============================ -->
<script>
    /* é€²åº¦æ¢ï¼šéš¨å¡«ç­”é€²åº¦é¡¯ç¤ºç™¾åˆ†æ¯” */
    const form = document.getElementById("surveyForm");
    const thankyou = document.querySelector(".thankyou");
    const progressBar = document.getElementById("progressBar");

    const updateProgress = () => {
      let answered = 0;
      const totalQuestions = 7; // ç¸½é¡Œæ•¸ï¼ˆå«å§“åï¼‰
      form.querySelectorAll("input, textarea").forEach(el => {
        if ((el.type === "radio" && el.checked) || 
            (el.type === "text" && el.value.trim() !== "") ||
            (el.type === "range" && el.value) ||
            (el.tagName === "TEXTAREA" && el.value.trim() !== "")) {
          answered++;
        }
      });
      progressBar.style.width = Math.min((answered / totalQuestions) * 100, 100) + "%";
    };
    form.addEventListener("input", updateProgress);

    /* è¡¨å–®é€å‡ºï¼šé€é fetch å‚³é€åˆ° save.php */
    form.addEventListener("submit", function(e) {
      e.preventDefault();
      fetch("save.php", {
        method: "POST",
        body: new FormData(form),
        headers: { 'Accept': 'application/json' }
      }).then(response => {
        if (response.ok) {
          form.reset();
          thankyou.style.display = "block";  // é¡¯ç¤ºæ„Ÿè¬è¨Šæ¯
          progressBar.style.width = "0%";
          // 2 ç§’å¾Œè·³è½‰åˆ°æ„Ÿè¬é 
          setTimeout(() => {
            window.location.href = "thankyou.html";
          }, 2000);
        } else {
          alert("é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ï¼");
        }
      }).catch(() => { alert("ç„¡æ³•é€£ç·šåˆ°ä¼ºæœå™¨ï¼"); });
    });

    /* ä¸»é¡Œåˆ‡æ›ï¼šäº®è‰² â†” æš—è‰² */
    const themeToggle = document.getElementById("themeToggle");
    const setTheme = (theme) => {
      document.body.classList.toggle("dark", theme === "dark");
      themeToggle.textContent = theme === "dark" ? "â˜€ï¸" : "ğŸŒ™";
      localStorage.setItem("theme", theme);
    };
    themeToggle.addEventListener("click", () => {
      const current = document.body.classList.contains("dark") ? "dark" : "light";
      setTheme(current === "dark" ? "light" : "dark");
    });
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme) {
      setTheme(savedTheme);
    } else {
      setTheme(window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light");
    }
  </script>
<div id="loadingBackdrop"><div class="loading-card"><span class="spinner"></span>è³‡æ–™é€å‡ºä¸­ï¼Œè«‹ç¨å€™â€¦</div></div><script id="redirect-after-submit">
document.addEventListener("DOMContentLoaded", function () {
  var form = document.getElementById("surveyForm") || document.querySelector("form");
  if (!form) return;

  // æ‰¾é€å‡ºæŒ‰éˆ•
  var submitBtn = form.querySelector('[type="submit"]');
  var backdrop = document.getElementById("loadingBackdrop");

  function showLoading(show){
    if(!backdrop) return;
    backdrop.classList[show ? "add" : "remove"]("show");
  }

  function setSubmitting(submitting){
    if(submitBtn){
      submitBtn.disabled = !!submitting;
      if(submitting){
        if(!submitBtn.getAttribute("data-origtxt")){
          submitBtn.setAttribute("data-origtxt", submitBtn.textContent.trim());
        }
        submitBtn.textContent = "é€å‡ºä¸­â€¦";
      }else{
        var orig = submitBtn.getAttribute("data-origtxt");
        if(orig){ submitBtn.textContent = orig; }
      }
    }
  }

  form.addEventListener("submit", function (e) {
    // è‹¥ç€è¦½å™¨åœç”¨ JSï¼Œè¡¨å–®å°‡ä¾åŸ action æ­£å¸¸é€å‡º
    e.preventDefault();

    setSubmitting(true);
    showLoading(true);

    var formData = new FormData(form);
    var action = form.getAttribute("action") || window.location.href;
    var method = (form.getAttribute("method") || "GET").toUpperCase();

    // è¨­å®š 15 ç§’é€¾æ™‚
    var controller = new AbortController();
    var timer = setTimeout(function(){ controller.abort(); }, 15000);

    fetch(action, {
      method: method,
      body: method === "GET" ? null : formData,
      signal: controller.signal
    }).then(function (res) {
      clearTimeout(timer);
      // å˜—è©¦ä¾ç…§å¾Œç«¯å›å‚³æ±ºå®šæ˜¯å¦å°å‘
      var contentType = res.headers.get("content-type") || "";

      if (!res.ok) {
        throw new Error("ä¼ºæœå™¨å›æ‡‰ç‹€æ…‹ç¢¼ï¼š" + res.status);
      }

      // å‡è¨­å¾Œç«¯å¯èƒ½å› JSONï¼š{ success: true, redirect: "thankyou.html" }
      if (contentType.includes("application/json")) {
        return res.json().then(function (data) {
          if (data && (data.success === true || data.status === "ok")) {
            var url = data.redirect || "thankyou.html";
            window.location.href = url;
            return;
          }
          // è‹¥ JSON æœªæ˜ç¢ºæ¨™ç¤ºæˆåŠŸï¼Œä» fallback å°å‘æ„Ÿè¬é 
          window.location.href = "thankyou.html";
        });
      }

      // è‹¥å›å‚³æ˜¯ HTML æˆ–å…¶ä»–æ ¼å¼ï¼Œåªè¦æˆåŠŸå°±å°å‘æ„Ÿè¬é 
      window.location.href = "thankyou.html";
    }).catch(function (err) {
      clearTimeout(timer);
      setSubmitting(false);
      showLoading(false);
      alert("é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚\nåŸå› ï¼š" + (err && err.message ? err.message : err));
    });
  }, { once: true });
});
// --- Netlify + Brevo integration ---
form.addEventListener("submit", function (e) {
  e.preventDefault();
  const formData = new FormData(form);
  const payload = Object.fromEntries(formData.entries());
  payload.userAgent = navigator.userAgent;
  payload.submittedAt = new Date().toISOString();

  setSubmitting(true);
  showLoading(true);

  fetch(form.getAttribute("action"), {
    method: "POST",
    headers: { "content-type": "application/json" },
    body: JSON.stringify(payload),
  }).then(async (res) => {
    if (!res.ok) {
      const t = await res.text().catch(() => "");
      throw new Error("æäº¤å¤±æ•—ï¼š" + res.status + " " + t);
    }
    window.location.href = "thankyou.html";
  }).catch((err) => {
    alert("é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚\nåŸå› ï¼š" + (err && err.message ? err.message : err));
  }).finally(() => {
    setSubmitting(false);
    showLoading(false);
  });
}, { once: true });

</script></body>
</html>
